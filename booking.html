<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="booking.page_title">R√©server un cours - YoTeach</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üá´üá∑</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="booking.css">
</head>
<body>
    <!-- Header r√©duit -->
    <header class="main-header scrolled">
        <div class="container">
            <div class="header-content">
                <button class="hamburger-menu" id="hamburgerBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <div class="logo-section">
                    <a href="index.html" class="logo">Yoann</a>
                    <div class="flag">üá´üá∑</div>
                </div>
                
                <a href="login.html" class="mobile-login-btn-header">Connexion</a>
                
                <!-- Groupe droit pour langue, devise et avatar -->
                <div class="header-right-group">
                    <!-- Avatar utilisateur -->
                    <div class="user-avatar" id="userAvatar" style="display: none;">
                        <div class="avatar-img" id="avatarInitials">Y</div>
                        <div class="user-menu">
                            <a href="dashboard.html" data-i18n="dashboard.my_dashboard">Mon tableau de bord</a>
                            <a href="profile.html" data-i18n="dashboard.my_profile">Mon profil</a>
                            <a href="bookings.html" data-i18n="payment.my_bookings">Mes r√©servations</a>
                            <a href="#" class="logout-btn" id="logoutBtn" data-i18n="dashboard.logout">D√©connexion</a>
                        </div>
                    </div>
                    
                    <!-- S√©lecteur de devise -->
                    <div class="currency-selector">
                        <i class="fas fa-money-bill-wave"></i>
                        <select id="currencySelector">
                            <!-- Rempli dynamiquement par currency.js -->
                        </select>
                    </div>
                    
                    <!-- S√©lecteur de langue -->
                    <div class="language-switcher" id="languageSwitcherDesktop">
                        <span class="flag">üåê</span>
                        <span data-i18n="header.language">EN</span>
                    </div>
                    
                    <!-- Bouton de connexion (visible si non connect√©) -->
                    <a href="login.html" class="login-btn" id="loginBtn" data-i18n="header.login">Connexion</a>
                </div>
            </div>
        </div>
        
        <!-- Menu Mobile -->
        <div class="mobile-menu-overlay" id="mobileMenu">
            <nav class="mobile-nav">
                <button class="close-menu" id="closeMenuBtn">√ó</button>
                <!-- La section utilisateur sera ajout√©e dynamiquement ici -->
                <a href="index.html#about" class="mobile-nav-link" data-i18n="nav.about">√Ä propos</a>
                <a href="index.html#courses" class="mobile-nav-link" data-i18n="nav.courses">Cours</a>
                <a href="index.html#testimonials" class="mobile-nav-link" data-i18n="nav.testimonials">T√©moignages</a>
                <a href="index.html#contact" class="mobile-nav-link" data-i18n="nav.contact">Contact</a>
                
                <!-- S√©lecteur de devise mobile -->
                <div class="currency-selector-mobile">
                    <label><i class="fas fa-money-bill-wave"></i> Devise</label>
                    <select id="currencySelectorMobile">
                        <!-- Rempli dynamiquement -->
                    </select>
                </div>
                
                <div class="mobile-language" id="languageSwitcherMobile">
                    <span class="flag">üåê</span>
                    <span data-i18n="header.language">EN</span>
                </div>
                
                <a href="login.html" class="mobile-login-btn" data-i18n="header.login">Connexion</a>
            </nav>
        </div>
    </header>

    <section class="booking-section">
        <div class="booking-container">
            <div class="booking-header">
                <h1 class="booking-title" data-i18n="booking.title">R√©server un cours</h1>
                <p class="booking-subtitle" data-i18n="booking.subtitle">Choisissez la date, l'heure et le type de cours qui vous convient</p>
            </div>

            <div class="error-message" id="errorMessage">
                <i class="fas fa-exclamation-circle"></i> <span id="errorText"></span>
            </div>

            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i> <span id="successText"></span>
            </div>

            <div class="booking-grid">
                <!-- Colonne gauche : Calendrier et cr√©neaux -->
                <div class="booking-card">
                    <h2 class="card-title" data-i18n="booking.choose_slot">Choisir un cr√©neau</h2>
                    
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <div class="month-year" id="currentMonth">Janvier 2024</div>
                            <div class="calendar-nav">
                                <button id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                                <button id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                        
                        <div class="calendar-grid" id="calendarDays">
                            <!-- Les jours seront g√©n√©r√©s par JavaScript -->
                        </div>
                    </div>

                    <h3 style="margin-bottom: 15px;" data-i18n="booking.available_slots">Cr√©neaux disponibles</h3>
                    <div class="time-slots" id="timeSlots">
                        <!-- Les cr√©neaux seront g√©n√©r√©s par JavaScript -->
                    </div>
                </div>

                <!-- Colonne droite : Formulaire et r√©capitulatif -->
                <div class="booking-card">
                    <h2 class="card-title" data-i18n="booking.details">D√©tails de la r√©servation</h2>
                    
                    <!-- Message de connexion requise -->
                    <div class="login-required" id="loginRequired" style="display: none;">
                        <i class="fas fa-info-circle"></i> <span data-i18n="booking.login_required">Pour r√©server un cours</span> <span id="courseTypeName"></span>, 
                        <a href="login.html" id="loginLink" data-i18n="booking.connect">connectez-vous</a> <span data-i18n="booking.or">ou</span> 
                        <a href="signup.html" id="signupLink" data-i18n="booking.create_account">cr√©ez un compte</a>.
                    </div>
                    
                    <form id="bookingForm">
                        <div class="form-group">
                            <label class="form-label" for="courseType" data-i18n="booking.course_type">Type de cours</label>
                            <select id="courseType" class="form-select" required>
                                <option value="" data-i18n="booking.select_course">S√©lectionnez un type de cours</option>
                                <option value="essai" data-i18n="courses.trial">Cours d'essai (15 min)</option>
                                <option value="conversation" data-i18n="courses.conversation">Conversation</option>
                                <option value="curriculum" data-i18n="courses.curriculum">Curriculum complet</option>
                                <option value="examen" data-i18n="courses.exam">Pr√©paration d'examen</option>
                            </select>
                        </div>

                        <!-- S√©lecteur de dur√©e en bulles cliquables -->
                        <div class="form-group duration-group" id="durationGroup">
                            <label class="form-label" data-i18n="booking.duration">Dur√©e du cours</label>
                            <div class="duration-options">
                                <button type="button" class="duration-option" data-duration="30" data-price-eur="10" data-i18n="courses.detail_30min">30 min</button>
                                <button type="button" class="duration-option" data-duration="45" data-price-eur="15" data-i18n="courses.detail_45min">45 min</button>
                                <button type="button" class="duration-option" data-duration="60" data-price-eur="20" data-selected="true" data-i18n="courses.duration_60">60 min</button>
                            </div>
                            <input type="hidden" id="duration" value="60">
                            <input type="hidden" id="basePriceEUR" value="20">
                        </div>

                        <!-- Nouveau: S√©lecteur du nombre de cours -->
                        <div class="form-group courses-count-group" id="coursesCountGroup">
                            <label class="form-label" data-i18n="booking.courses_count">Nombre de cours</label>
                            <div class="courses-count-options">
                                <button type="button" class="courses-count-option selected" data-count="1" data-discount="0" data-i18n="booking.one_course">
                                    1 cours
                                </button>
                                <button type="button" class="courses-count-option" data-count="5" data-discount="2" data-i18n="booking.five_courses">
                                    5 cours
                                    <span class="discount-badge" data-i18n="booking.discount_badge">-2%</span>
                                </button>
                                <button type="button" class="courses-count-option" data-count="10" data-discount="5" data-i18n="booking.ten_courses">
                                    10 cours
                                    <span class="discount-badge" data-i18n="booking.discount_badge_5">-5%</span>
                                </button>
                            </div>
                            <input type="hidden" id="coursesCount" value="1">
                            <input type="hidden" id="discountPercent" value="0">
                        </div>

                        <!-- S√©lecteur de moyen de communication -->
                        <div class="form-group" id="locationGroup">
                            <label class="form-label" data-i18n="booking.communication">Moyen de communication</label>
                            <div class="duration-options">
                                <button type="button" class="duration-option location-btn" data-location="integrations:zoom">
                                    <i class="fab fa-zoom"></i> <span data-i18n="booking.zoom">Zoom</span>
                                </button>
                                <button type="button" class="duration-option location-btn" data-location="https://teams.live.com/l/invite/FEAJFWoKc8mbrQCGwM?v=g1">
                                    <i class="fab fa-microsoft"></i> <span data-i18n="booking.teams">Teams</span>
                                </button>
                                <button type="button" class="duration-option location-btn selected" data-location="integrations:google:meet">
                                    <i class="fab fa-google"></i> <span data-i18n="booking.meet">Meet</span>
                                </button>
                            </div>
                            <input type="hidden" id="selectedLocation" value="integrations:google:meet">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="name" data-i18n="booking.full_name">Nom complet</label>
                            <input type="text" id="name" class="form-input" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="email" data-i18n="booking.email">Email</label>
                            <input type="email" id="email" class="form-input" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="notes" data-i18n="booking.notes">Notes pour le professeur (optionnel)</label>
                            <textarea id="notes" class="form-textarea" placeholder="Votre niveau, objectifs, sujets de discussion pr√©f√©r√©s..." data-i18n-placeholder="booking.notes_placeholder"></textarea>
                        </div>

                        <div class="booking-summary">
                            <h3 style="margin-bottom: 15px;" data-i18n="booking.summary">R√©capitulatif</h3>
                            <div class="summary-item">
                                <span data-i18n="booking.summary_type">Type de cours:</span>
                                <span id="summaryType">-</span>
                            </div>
                            <div class="summary-item">
                                <span data-i18n="booking.summary_courses">Nombre de cours:</span>
                                <span id="summaryCoursesCount">1 cours</span>
                            </div>
                            <div class="summary-item">
                                <span data-i18n="booking.summary_discount">R√©duction:</span>
                                <span id="summaryDiscount">0%</span>
                            </div>
                            <div class="summary-item">
                                <span data-i18n="booking.summary_date">Date:</span>
                                <span id="summaryDate">-</span>
                            </div>
                            <div class="summary-item">
                                <span data-i18n="booking.summary_time">Heure:</span>
                                <span id="summaryTime">-</span>
                            </div>
                            <div class="summary-item">
                                <span data-i18n="booking.summary_duration">Dur√©e:</span>
                                <span id="summaryDuration">-</span>
                            </div>
                            <div class="summary-item">
                                <span data-i18n="booking.summary_platform">Plateforme:</span>
                                <span id="summaryPlatform">Google Meet</span>
                            </div>
                            <div class="summary-item total">
                                <span data-i18n="booking.summary_total">Total:</span>
                                <span id="summaryPrice">-</span>
                            </div>
                        </div>

                        <button type="submit" class="btn-booking" id="submitBooking" disabled style="background: linear-gradient(135deg, #3c84f6, #1e88e5);">
                            <i class="fas fa-calendar-check"></i> <span data-i18n="booking.book_and_pay">R√©server et payer</span>
                        </button>
                        
                        <div style="margin-top: 15px; text-align: center; font-size: 0.9rem; color: #666;">
                            
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    <script src="currency.js"></script>
    <script src="translation.js"></script>
    <script src="packages.js"></script>
    <script src="auth.js"></script>
    <script src="booking.js"></script>
    <script src="common.js"></script>
    <script src="booking-ui.js"></script>
</body>
</html>
