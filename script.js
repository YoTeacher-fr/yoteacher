// ===== TRADUCTIONS =====
const translations = {
    fr: {
        // Navigation
        'title': 'Yoann - Professeur de Fran√ßais pour Adultes',
        'nav.about': '√Ä propos',
        'nav.courses': 'Cours',
        'nav.testimonials': 'T√©moignages',
        'nav.contact': 'Contact',
        'nav.login': 'Connexion',
        'nav.language': 'English (EN)',
        
        // Hero
        'hero.title': 'Apprenez le fran√ßais simplement',
        'hero.subtitle': 'Professeur natif ‚Ä¢ Cours chaleureux et personnalis√©s pour adultes',
        'stats.years.desktop': 'Ans d\'exp√©rience',
        'stats.years.mobile': 'Ans d\'exp√©rience',
        'stats.students.desktop': '√âtudiants',
        'stats.students.mobile': '√âtudiants accompagn√©s',
        'stats.lessons': 'Le√ßons donn√©es',
        'buttons.trial': 'R√©server un cours d\'essai',
        'buttons.account': 'Cr√©er un compte gratuit',
        
        // About
        'about.label': '√Ä propos de Yoann',
        'about.title': 'Votre guide vers la ma√Ætrise du',
        'about.language': 'fran√ßais',
        'about.text1': 'Bonjour ! Je suis Yoann, professeur de fran√ßais passionn√© depuis 4 ans. Originaire de Marseille, dans le sud de la France, j\'ai d√©cid√© de quitter ma carri√®re de comptable pour suivre ma vraie passion : enseigner le fran√ßais et voyager √† travers le monde.',
        'about.text2': 'Avec plus de 75 pays visit√©s en 6 ans, j\'apporte une richesse culturelle unique √† mes cours. Cette exp√©rience me permet d\'aborder des sujets vari√©s et de comprendre les d√©fis sp√©cifiques de chaque culture dans l\'apprentissage du fran√ßais.',
        'about.highlight1': 'Originaire de Marseille',
        'about.highlight2': '75 pays visit√©s',
        'about.highlight3': 'Ancien comptable reconverti',
        'about.highlight4': 'Certifi√© en anglais',
        'about.personality.title': 'Ce que mes √©tudiants disent de moi :',
        'about.personality.tag1': 'Professionnel',
        'about.personality.tag2': 'Chaleureux et sociable',
        'about.personality.tag3': 'Ouvert d\'esprit',
        'about.personality.tag4': 'Aventureux',
        'about.personality.tag5': 'Bienveillant',
        'about.personality.tag6': 'Dynamique',
        
        // Courses
        'courses.label': 'Mes cours',
        'courses.title': 'Des formules adapt√©es √†',
        'courses.title.highlight': 'vos besoins',
        'courses.subtitle': 'Choisissez la formule qui vous convient et commencez votre voyage linguistique',
        
        // Testimonials
        'testimonials.label': 'T√©moignages',
        'testimonials.title': 'Ce que disent mes',
        'testimonials.title.highlight': '√©tudiants',
        'testimonials.subtitle': 'Plus de 500 √©tudiants satisfaits √† travers le monde',
        
        // CTA
        'cta.title': 'Pr√™t √† commencer votre voyage vers la',
        'cta.title.highlight': 'ma√Ætrise du fran√ßais',
        'cta.title.question': '?',
        'cta.subtitle': 'Rejoignez plus de 500 √©tudiants satisfaits. R√©servez votre cours d\'essai aujourd\'hui et d√©couvrez une nouvelle fa√ßon d\'apprendre le fran√ßais.',
        'cta.button.trial': 'Essayer maintenant - 5‚Ç¨',
        'cta.button.account': 'Cr√©er un compte gratuit',
        'cta.note': 'üîí Paiement s√©curis√© ‚Ä¢ Annulation gratuite 24h avant',
        
        // Footer
        'footer.brand': 'Teacher',
        'footer.description': 'Cours de fran√ßais en ligne pour adultes. Apprenez avec confiance et plaisir avec un professeur natif passionn√©.',
        'footer.stat1': 'Professeur natif de Marseille',
        'footer.stat2': '75 pays visit√©s',
        'footer.stat3': '500+ √©tudiants',
        'footer.links.title': 'Liens rapides',
        'footer.links.home': 'Accueil',
        'footer.links.about': '√Ä propos',
        'footer.links.courses': 'Cours',
        'footer.links.testimonials': 'T√©moignages',
        'footer.links.contact': 'Contact',
        'footer.legal.title': 'Mentions l√©gales',
        'footer.legal.legal': 'Mentions l√©gales',
        'footer.legal.terms': 'Conditions G√©n√©rales de Vente',
        'footer.legal.privacy': 'Politique de confidentialit√©',
        'footer.legal.cancellation': 'Politique d\'annulation',
        'footer.copyright': '¬© 2024 YoTeacher. Fait avec',
        'footer.location': '√† Marseille'
    },
    
    en: {
        // Navigation
        'title': 'Yoann - French Teacher for Adults',
        'nav.about': 'About',
        'nav.courses': 'Courses',
        'nav.testimonials': 'Testimonials',
        'nav.contact': 'Contact',
        'nav.login': 'Login',
        'nav.language': 'Fran√ßais (FR)',
        
        // Hero
        'hero.title': 'Learn French Simply',
        'hero.subtitle': 'Native Teacher ‚Ä¢ Warm and Personalized Lessons for Adults',
        'stats.years.desktop': 'Years of Experience',
        'stats.years.mobile': 'Years of Experience',
        'stats.students.desktop': 'Students',
        'stats.students.mobile': 'Students Assisted',
        'stats.lessons': 'Lessons Given',
        'buttons.trial': 'Book a Trial Lesson',
        'buttons.account': 'Create Free Account',
        
        // About
        'about.label': 'About Yoann',
        'about.title': 'Your Guide to Mastering',
        'about.language': 'French',
        'about.text1': 'Hello! I\'m Yoann, a passionate French teacher for 4 years. Originally from Marseille in the south of France, I decided to leave my accounting career to follow my true passion: teaching French and traveling around the world.',
        'about.text2': 'With over 75 countries visited in 6 years, I bring unique cultural richness to my lessons. This experience allows me to discuss varied topics and understand the specific challenges of each culture in learning French.',
        'about.highlight1': 'From Marseille',
        'about.highlight2': '75 Countries Visited',
        'about.highlight3': 'Former Accountant Retrained',
        'about.highlight4': 'English Certified',
        'about.personality.title': 'What my students say about me:',
        'about.personality.tag1': 'Professional',
        'about.personality.tag2': 'Warm and Sociable',
        'about.personality.tag3': 'Open-minded',
        'about.personality.tag4': 'Adventurous',
        'about.personality.tag5': 'Kind',
        'about.personality.tag6': 'Dynamic',
        
        // Courses
        'courses.label': 'My Courses',
        'courses.title': 'Formulas Adapted to',
        'courses.title.highlight': 'Your Needs',
        'courses.subtitle': 'Choose the formula that suits you and start your language journey',
        
        // Testimonials
        'testimonials.label': 'Testimonials',
        'testimonials.title': 'What My',
        'testimonials.title.highlight': 'Students Say',
        'testimonials.subtitle': 'Over 500 Satisfied Students Worldwide',
        
        // CTA
        'cta.title': 'Ready to Start Your Journey to',
        'cta.title.highlight': 'French Mastery',
        'cta.title.question': '?',
        'cta.subtitle': 'Join over 500 satisfied students. Book your trial lesson today and discover a new way to learn French.',
        'cta.button.trial': 'Try Now - 5‚Ç¨',
        'cta.button.account': 'Create Free Account',
        'cta.note': 'üîí Secure Payment ‚Ä¢ Free Cancellation 24h Before',
        
        // Footer
        'footer.brand': 'Teacher',
        'footer.description': 'Online French lessons for adults. Learn with confidence and pleasure with a passionate native teacher.',
        'footer.stat1': 'Native Teacher from Marseille',
        'footer.stat2': '75 Countries Visited',
        'footer.stat3': '500+ Students',
        'footer.links.title': 'Quick Links',
        'footer.links.home': 'Home',
        'footer.links.about': 'About',
        'footer.links.courses': 'Courses',
        'footer.links.testimonials': 'Testimonials',
        'footer.links.contact': 'Contact',
        'footer.legal.title': 'Legal',
        'footer.legal.legal': 'Legal Notice',
        'footer.legal.terms': 'Terms of Service',
        'footer.legal.privacy': 'Privacy Policy',
        'footer.legal.cancellation': 'Cancellation Policy',
        'footer.copyright': '¬© 2024 YoTeacher. Made with',
        'footer.location': 'in Marseille'
    }
};

// ===== DONN√âES DES COURS FRAN√áAIS =====
const coursesDataFR = [
    {
        id: 1,
        type: "Conversation",
        focus: "Discussion uniquement",
        price: 20,
        duration: "60 minutes",
        features: [
            "Fluidit√© √† l'oral",
            "Vocabulaire quotidien",
            "Correction en temps r√©el",
            "Sujets vari√©s d'actualit√©"
        ],
        details: [
            { duration: "30min", price: 10 },
            { duration: "45min", price: 15 },
            { duration: "Forfait 10 cours", price: 190, discount: "(-5%)" }
        ],
        buttonText: "R√©server",
        featured: false
    },
    {
        id: 2,
        type: "Curriculum Complet",
        focus: "Grammaire, exercices, structure",
        price: 35,
        duration: "60 minutes",
        features: [
            "Grammaire approfondie",
            "Exercices personnalis√©s",
            "Structure compl√®te",
            "Programme sur mesure"
        ],
        details: [
            { duration: "Forfait 10 cours", price: 332.50, discount: "(-5%)" }
        ],
        buttonText: "Choisir ce cours",
        featured: true
    },
    {
        id: 3,
        type: "Cours d'Essai",
        focus: "Premier contact, √©valuation",
        price: 5,
        duration: "15 minutes",
        features: [
            "√âvaluation de votre niveau",
            "D√©finition des objectifs",
            "D√©couverte de la m√©thode"
        ],
        details: [
            { duration: "Confirmation automatique" }
        ],
        buttonText: "Essayer",
        featured: false
    }
];

// ===== DONN√âES DES COURS ANGLAIS =====
const coursesDataEN = [
    {
        id: 1,
        type: "Conversation",
        focus: "Speaking Only",
        price: 20,
        duration: "60 minutes",
        features: [
            "Oral Fluency",
            "Everyday Vocabulary",
            "Real-time Correction",
            "Varied Current Topics"
        ],
        details: [
            { duration: "30min", price: 10 },
            { duration: "45min", price: 15 },
            { duration: "10-lesson Pack", price: 190, discount: "(-5%)" }
        ],
        buttonText: "Book Now",
        featured: false
    },
    {
        id: 2,
        type: "Complete Curriculum",
        focus: "Grammar, Exercises, Structure",
        price: 35,
        duration: "60 minutes",
        features: [
            "In-depth Grammar",
            "Personalized Exercises",
            "Complete Structure",
            "Tailored Program"
        ],
        details: [
            { duration: "10-lesson Pack", price: 332.50, discount: "(-5%)" }
        ],
        buttonText: "Choose This Course",
        featured: true
    },
    {
        id: 3,
        type: "Trial Lesson",
        focus: "First Contact, Evaluation",
        price: 5,
        duration: "15 minutes",
        features: [
            "Level Evaluation",
            "Goal Setting",
            "Method Discovery"
        ],
        details: [
            { duration: "Automatic Confirmation" }
        ],
        buttonText: "Try It",
        featured: false
    }
];

// ===== DONN√âES DES T√âMOIGNAGES FRAN√áAIS =====
const testimonialsDataFR = [
    {
        id: 1,
        name: "Marina",
        country: "üáßüá∑ Br√©sil",
        content: "Yoann est un professeur fantastique ! Ses cours sont dynamiques et il sait vraiment comment me mettre √† l'aise. J'ai fait des progr√®s incroyables en seulement quelques mois.",
        rating: 5,
        lessons: "42 cours"
    },
    {
        id: 2,
        name: "Kay",
        country: "üá∫üá∏ √âtats-Unis",
        content: "J'adore apprendre avec Yoann. Il est patient, professionnel et ses cours sont toujours bien pr√©par√©s. Il s'adapte parfaitement √† mon niveau et mes besoins.",
        rating: 5,
        lessons: "28 cours"
    },
    {
        id: 3,
        name: "Julia",
        country: "üá©üá™ Allemagne",
        content: "Les cours avec Yoann sont un vrai plaisir ! Il cr√©e une atmosph√®re d√©tendue o√π je n'ai pas peur de faire des erreurs. Ma confiance en fran√ßais a vraiment augment√©.",
        rating: 5,
        lessons: "15 cours"
    },
    {
        id: 4,
        name: "Octavi",
        country: "üá™üá∏ Espagne",
        content: "Yoann est chaleureux et ouvert d'esprit. Ses voyages dans 75 pays rendent nos conversations tr√®s int√©ressantes. Je recommande vivement !",
        rating: 5,
        lessons: "56 cours"
    },
    {
        id: 5,
        name: "Nah√©ma",
        country: "üá®üá¶ Canada",
        content: "Gr√¢ce √† Yoann, j'ai r√©ussi mon examen DELF B2 ! Sa m√©thode de pr√©paration est efficace et il sait exactement comment vous pr√©parer au succ√®s.",
        rating: 5,
        lessons: "24 cours"
    },
    {
        id: 6,
        name: "Chen",
        country: "üá®üá≥ Chine",
        content: "Professeur tr√®s professionnel et bienveillant. Il prend le temps d'expliquer la grammaire clairement et les cours sont toujours vivants et dynamiques.",
        rating: 5,
        lessons: "37 cours"
    },
    {
        id: 7,
        name: "Luca",
        country: "üáÆüáπ Italie",
        content: "Je pr√©pare le DELF B1 avec Yoann et ses conseils sont pr√©cieux. Il conna√Æt parfaitement les exigences de l'examen.",
        rating: 5,
        lessons: "18 cours"
    },
    {
        id: 8,
        name: "Sofia",
        country: "üá¶üá∑ Argentine",
        content: "Les cours avec Yoann sont toujours tr√®s structur√©s et int√©ressants. J'ai beaucoup progress√© en compr√©hension orale.",
        rating: 5,
        lessons: "32 cours"
    },
    {
        id: 9,
        name: "Ahmed",
        country: "üá≤üá¶ Maroc",
        content: "Professeur exceptionnel ! Yoann sait s'adapter √† chaque √©l√®ve et rend l'apprentissage du fran√ßais agr√©able.",
        rating: 5,
        lessons: "25 cours"
    }
];

// ===== DONN√âES DES T√âMOIGNAGES ANGLAIS =====
const testimonialsDataEN = [
    {
        id: 1,
        name: "Marina",
        country: "üáßüá∑ Brazil",
        content: "Yoann is a fantastic teacher! His classes are dynamic and he really knows how to make me feel comfortable. I've made incredible progress in just a few months.",
        rating: 5,
        lessons: "42 lessons"
    },
    {
        id: 2,
        name: "Kay",
        country: "üá∫üá∏ USA",
        content: "I love learning with Yoann. He is patient, professional, and his classes are always well prepared. He perfectly adapts to my level and needs.",
        rating: 5,
        lessons: "28 lessons"
    },
    {
        id: 3,
        name: "Julia",
        country: "üá©üá™ Germany",
        content: "Classes with Yoann are a real pleasure! He creates a relaxed atmosphere where I'm not afraid to make mistakes. My confidence in French has really increased.",
        rating: 5,
        lessons: "15 lessons"
    },
    {
        id: 4,
        name: "Octavi",
        country: "üá™üá∏ Spain",
        content: "Yoann is warm and open-minded. His travels to 75 countries make our conversations very interesting. Highly recommended!",
        rating: 5,
        lessons: "56 lessons"
    },
    {
        id: 5,
        name: "Nah√©ma",
        country: "üá®üá¶ Canada",
        content: "Thanks to Yoann, I passed my DELF B2 exam! His preparation method is effective and he knows exactly how to prepare you for success.",
        rating: 5,
        lessons: "24 lessons"
    },
    {
        id: 6,
        name: "Chen",
        country: "üá®üá≥ China",
        content: "Very professional and kind teacher. He takes the time to explain grammar clearly and classes are always lively and dynamic.",
        rating: 5,
        lessons: "37 lessons"
    },
    {
        id: 7,
        name: "Luca",
        country: "üáÆüáπ Italy",
        content: "I'm preparing for DELF B1 with Yoann and his advice is valuable. He knows the exam requirements perfectly.",
        rating: 5,
        lessons: "18 lessons"
    },
    {
        id: 8,
        name: "Sofia",
        country: "üá¶üá∑ Argentina",
        content: "Classes with Yoann are always well structured and interesting. I've made great progress in oral comprehension.",
        rating: 5,
        lessons: "32 lessons"
    },
    {
        id: 9,
        name: "Ahmed",
        country: "üá≤üá¶ Morocco",
        content: "Exceptional teacher! Yoann knows how to adapt to each student and makes learning French enjoyable.",
        rating: 5,
        lessons: "25 lessons"
    }
];

// ===== CONFIGURATION =====
const CONFIG = {
    autoScrollOffset: 80,
    coursesScrollOffset: 200
};

// ===== √âTAT GLOBAL =====
let state = {
    testimonialsLoaded: false,
    currentTestimonialSlide: 0
};

// ===== GESTIONNAIRE DE LANGUE =====
const languageManager = {
    currentLang: 'fr',
    
    init: () => {
        // Restaurer la langue sauvegard√©e
        const savedLang = localStorage.getItem('siteLanguage');
        if (savedLang) {
            languageManager.currentLang = savedLang;
        }
        
        // √âv√©nements desktop
        const languageSwitcher = document.getElementById('languageSwitcher');
        if (languageSwitcher) {
            languageSwitcher.addEventListener('click', (e) => {
                e.preventDefault();
                languageManager.toggleLanguage();
            });
        }
        
        // √âv√©nements mobile
        const mobileLanguageSwitcher = document.getElementById('mobileLanguageSwitcher');
        if (mobileLanguageSwitcher) {
            mobileLanguageSwitcher.addEventListener('click', (e) => {
                e.preventDefault();
                languageManager.toggleLanguage();
                mobileMenuManager.closeMobileMenu();
            });
        }
        
        // Mettre √† jour les textes et l'affichage du bouton
        languageManager.updateAllTexts();
        languageManager.updateLanguageDisplay();
        
        console.log('Language manager initialis√©, langue:', languageManager.currentLang);
    },
    
    toggleLanguage: () => {
        languageManager.currentLang = languageManager.currentLang === 'fr' ? 'en' : 'fr';
        localStorage.setItem('siteLanguage', languageManager.currentLang);
        
        // Mettre √† jour tous les textes
        languageManager.updateAllTexts();
        
        // Mettre √† jour l'affichage du bouton (oppos√©)
        languageManager.updateLanguageDisplay();
        
        // Reg√©n√©rer les sections dynamiques
        coursesManager.init();
        testimonialsManager.init();
    },
    
    updateLanguageDisplay: () => {
        const languageText = document.querySelector('.language-switcher span:not(.flag)');
        const mobileLanguageText = document.querySelector('#mobileLanguageSwitcher span:not(.flag)');
        
        // AFFICHAGE OPPOS√â : Montrer la langue VERS LAQUELLE on peut basculer
        if (languageText) {
            // Si on est en fran√ßais, on montre "EN" (pour basculer en anglais)
            // Si on est en anglais, on montre "FR" (pour basculer en fran√ßais)
            languageText.textContent = languageManager.currentLang === 'fr' ? 'EN' : 'FR';
        }
        
        if (mobileLanguageText) {
            // M√™me logique pour le menu mobile
            mobileLanguageText.textContent = languageManager.currentLang === 'fr' 
                ? 'English (EN)'   // On est en fran√ßais, on propose anglais
                : 'Fran√ßais (FR)'; // On est en anglais, on propose fran√ßais
        }
    },
    
    updateAllTexts: () => {
        const lang = languageManager.currentLang;
        const langData = translations[lang];
        
        if (!langData) return;
        
        // Mettre √† jour les √©l√©ments avec data-i18n
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (langData[key]) {
                element.textContent = langData[key];
            }
        });
        
        // Mettre √† jour le titre de la page
        if (langData['title']) {
            document.title = langData['title'];
        }
        
        console.log('Textes mis √† jour en', lang);
    },
    
    getCurrentLanguage: () => {
        return languageManager.currentLang;
    }
};

// ===== FONCTIONS UTILITAIRES =====
const utils = {
    debounce: (func, wait) => {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    },
    
    showNotification: (message, type = 'info') => {
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
            <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
            <span>${message}</span>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.classList.add('show');
        }, 10);
        
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
    }
};

// ===== G√âN√âRATION DES COURS =====
const coursesManager = {
    init: () => {
        const container = document.getElementById('coursesContainer');
        if (!container) return;
        
        container.innerHTML = '';
        
        // Utiliser les donn√©es selon la langue
        const currentLang = languageManager.getCurrentLanguage();
        const dataToUse = currentLang === 'fr' ? coursesDataFR : coursesDataEN;
        
        dataToUse.forEach(course => coursesManager.createCourseCard(course, container));
        coursesManager.addCourseEvents();
    },
    
    createCourseCard: (course, container) => {
        const card = document.createElement('div');
        card.className = `course-card ${course.featured ? 'featured' : ''}`;
        card.setAttribute('data-course-id', course.id);
        
        // G√©n√©rer les d√©tails de prix
        let priceDetailsHTML = '';
        
        if (course.id === 1) {
            priceDetailsHTML = `
                <div style="margin-top: 10px; color: #666; font-weight: 500;">
                    ${course.details[0].duration} : ${course.details[0].price}‚Ç¨ ‚îÇ ${course.details[1].duration} : ${course.details[1].price}‚Ç¨
                </div>
            `;
        }
        
        // Ajouter les d√©tails suppl√©mentaires (forfaits)
        course.details.forEach(detail => {
            if (detail.discount) {
                priceDetailsHTML += `
                    <div style="margin-top: 10px; color: #4CAF50; font-weight: 600;">
                        ${detail.duration}: ${detail.price}‚Ç¨ ${detail.discount}
                    </div>
                `;
            } else if (detail.price && course.id !== 1) {
                priceDetailsHTML += `
                    <div style="margin-top: 10px; color: #666; font-weight: 500;">
                        ${detail.duration}: ${detail.price}‚Ç¨
                    </div>
                `;
            }
        });
        
        // G√©n√©rer les features
        const featuresHTML = course.features.map(feature => `
            <div class="course-feature">
                <i class="fas fa-check"></i>
                <span>${feature}</span>
            </div>
        `).join('');
        
        // HTML pour le prix avec "/h" en plus petit
        let priceHTML = '';
        if (course.id === 3) {
            priceHTML = `<span class="price-main">${course.price}‚Ç¨</span>`;
        } else {
            priceHTML = `
                <span class="price-main">${course.price}‚Ç¨<span class="price-per-hour">/h</span></span>
            `;
        }
        
        card.innerHTML = `
            <div class="course-header">
                <div class="course-type">${course.type}</div>
                <div class="course-focus">${course.focus}</div>
            </div>
            <div class="course-body">
                <div class="course-price">
                    ${priceHTML}
                    <div class="price-details">${priceDetailsHTML}</div>
                </div>
                
                <div class="course-features">
                    ${featuresHTML}
                </div>
                
                <button class="btn btn-primary course-book-btn" data-course="${course.id}">
                    ${course.buttonText}
                </button>
            </div>
        `;
        
        container.appendChild(card);
    },
    
    addCourseEvents: () => {
        document.querySelectorAll('.course-book-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const courseId = e.target.getAttribute('data-course');
                const currentLang = languageManager.getCurrentLanguage();
                const dataToUse = currentLang === 'fr' ? coursesDataFR : coursesDataEN;
                const course = dataToUse.find(c => c.id == courseId);
                
                if (course) {
                    utils.showNotification(
                        currentLang === 'fr' 
                            ? `R√©servation du cours "${course.type}" - Redirection en cours...` 
                            : `Booking "${course.type}" course - Redirecting...`,
                        'success'
                    );
                    
                    setTimeout(() => {
                        window.open('#', '_blank');
                    }, 1500);
                }
            });
        });
        
        // Animation au survol
        document.querySelectorAll('.course-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transition = 'all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            });
        });
    }
};

// ===== G√âN√âRATION DES T√âMOIGNAGES =====
const testimonialsManager = {
    currentSlide: 0,
    slidesPerView: 3,
    
    init: () => {
        const container = document.getElementById('testimonialsSlider');
        const indicatorsContainer = document.getElementById('testimonialIndicators');
        
        if (!container) {
            console.error('Conteneur des t√©moignages non trouv√©');
            return;
        }
        
        // Calculer le nombre de slides en fonction de l'√©cran
        testimonialsManager.calculateSlidesPerView();
        
        // G√©n√©rer les t√©moignages selon la langue
        const currentLang = languageManager.getCurrentLanguage();
        const dataToUse = currentLang === 'fr' ? testimonialsDataFR : testimonialsDataEN;
        
        container.innerHTML = '';
        dataToUse.forEach((testimonial, index) => {
            const card = testimonialsManager.createTestimonialCard(testimonial);
            container.appendChild(card);
            
            // Afficher/masquer selon l'index
            if (index < testimonialsManager.slidesPerView) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
        
        // G√©n√©rer les indicateurs
        testimonialsManager.generateIndicators(indicatorsContainer);
        
        // Ajouter les √©v√©nements
        testimonialsManager.addTestimonialEvents();
        testimonialsManager.setupNavigation();
    },
    
    calculateSlidesPerView: () => {
        const width = window.innerWidth;
        if (width >= 992) {
            testimonialsManager.slidesPerView = 3;
        } else if (width >= 768) {
            testimonialsManager.slidesPerView = 2;
        } else {
            testimonialsManager.slidesPerView = 1;
        }
    },
    
    createTestimonialCard: (testimonial) => {
        const card = document.createElement('div');
        card.className = 'testimonial-card fade-in-up';
        card.setAttribute('data-testimonial-id', testimonial.id);
        
        // G√©n√©rer les √©toiles
        let starsHTML = '';
        for (let i = 0; i < testimonial.rating; i++) {
            starsHTML += '<i class="fas fa-star"></i>';
        }
        
        // Premi√®re lettre du nom
        const firstLetter = testimonial.name.charAt(0);
        
        card.innerHTML = `
            <div class="quote-icon">
                <i class="fas fa-quote-right"></i>
            </div>
            
            <div class="rating-stars">
                ${starsHTML}
            </div>
            
            <p class="testimonial-content">
                "${testimonial.content}"
            </p>
            
            <div class="testimonial-author">
                <div class="author-avatar">
                    ${firstLetter}
                </div>
                <div class="author-info">
                    <h4>${testimonial.name}</h4>
                    <p>${testimonial.country} ‚Ä¢ ${testimonial.lessons}</p>
                </div>
            </div>
        `;
        
        return card;
    },
    
    generateIndicators: (container) => {
        if (!container) return;
        
        const currentLang = languageManager.getCurrentLanguage();
        const dataToUse = currentLang === 'fr' ? testimonialsDataFR : testimonialsDataEN;
        const totalSlides = Math.ceil(dataToUse.length / testimonialsManager.slidesPerView);
        container.innerHTML = '';
        
        for (let i = 0; i < totalSlides; i++) {
            const indicator = document.createElement('button');
            indicator.className = `testimonial-indicator ${i === 0 ? 'active' : ''}`;
            indicator.setAttribute('data-slide', i);
            indicator.addEventListener('click', () => {
                testimonialsManager.goToSlide(i);
            });
            container.appendChild(indicator);
        }
    },
    
    setupNavigation: () => {
        const prevBtn = document.getElementById('prevTestimonial');
        const nextBtn = document.getElementById('nextTestimonial');
        
        if (prevBtn) {
            prevBtn.addEventListener('click', () => {
                testimonialsManager.prevSlide();
            });
        }
        
        if (nextBtn) {
            nextBtn.addEventListener('click', () => {
                testimonialsManager.nextSlide();
            });
        }
        
        // Navigation au clavier
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                testimonialsManager.prevSlide();
            } else if (e.key === 'ArrowRight') {
                testimonialsManager.nextSlide();
            }
        });
        
        // Redimensionnement de la fen√™tre
        window.addEventListener('resize', () => {
            testimonialsManager.calculateSlidesPerView();
            testimonialsManager.updateSlider();
            testimonialsManager.generateIndicators(document.getElementById('testimonialIndicators'));
        });
    },
    
    prevSlide: () => {
        const currentLang = languageManager.getCurrentLanguage();
        const dataToUse = currentLang === 'fr' ? testimonialsDataFR : testimonialsDataEN;
        const totalSlides = Math.ceil(dataToUse.length / testimonialsManager.slidesPerView);
        testimonialsManager.currentSlide = (testimonialsManager.currentSlide - 1 + totalSlides) % totalSlides;
        testimonialsManager.updateSlider();
    },
    
    nextSlide: () => {
        const currentLang = languageManager.getCurrentLanguage();
        const dataToUse = currentLang === 'fr' ? testimonialsDataFR : testimonialsDataEN;
        const totalSlides = Math.ceil(dataToUse.length / testimonialsManager.slidesPerView);
        testimonialsManager.currentSlide = (testimonialsManager.currentSlide + 1) % totalSlides;
        testimonialsManager.updateSlider();
    },
    
    goToSlide: (slideIndex) => {
        const currentLang = languageManager.getCurrentLanguage();
        const dataToUse = currentLang === 'fr' ? testimonialsDataFR : testimonialsDataEN;
        const totalSlides = Math.ceil(dataToUse.length / testimonialsManager.slidesPerView);
        if (slideIndex >= 0 && slideIndex < totalSlides) {
            testimonialsManager.currentSlide = slideIndex;
            testimonialsManager.updateSlider();
        }
    },
    
    updateSlider: () => {
        const container = document.getElementById('testimonialsSlider');
        const indicators = document.querySelectorAll('.testimonial-indicator');
        
        if (!container) return;
        
        // Masquer tous les t√©moignages
        const cards = container.querySelectorAll('.testimonial-card');
        cards.forEach(card => {
            card.style.display = 'none';
        });
        
        // Afficher seulement ceux de la slide actuelle
        const startIndex = testimonialsManager.currentSlide * testimonialsManager.slidesPerView;
        const endIndex = startIndex + testimonialsManager.slidesPerView;
        
        for (let i = startIndex; i < endIndex && i < cards.length; i++) {
            if (cards[i]) {
                cards[i].style.display = 'block';
            }
        }
        
        // Mettre √† jour les indicateurs
        indicators.forEach((indicator, index) => {
            if (index === testimonialsManager.currentSlide) {
                indicator.classList.add('active');
            } else {
                indicator.classList.remove('active');
            }
        });
        
        // Mettre √† jour les boutons de navigation
        const prevBtn = document.getElementById('prevTestimonial');
        const nextBtn = document.getElementById('nextTestimonial');
        const currentLang = languageManager.getCurrentLanguage();
        const dataToUse = currentLang === 'fr' ? testimonialsDataFR : testimonialsDataEN;
        const totalSlides = Math.ceil(dataToUse.length / testimonialsManager.slidesPerView);
        
        if (prevBtn) {
            prevBtn.disabled = testimonialsManager.currentSlide === 0;
        }
        
        if (nextBtn) {
            nextBtn.disabled = testimonialsManager.currentSlide === totalSlides - 1;
        }
    },
    
    addTestimonialEvents: () => {
        document.querySelectorAll('.testimonial-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-10px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    }
};

// ===== NAVIGATION =====
const navigationManager = {
    init: () => {
        // Navigation fluide
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                const href = this.getAttribute('href');
                if (href === '#') return;
                
                e.preventDefault();
                navigationManager.scrollToSection(href);
            });
        });
        
        // Boutons CTA
        document.querySelectorAll('.btn[href^="#"]').forEach(btn => {
            btn.addEventListener('click', function(e) {
                const href = this.getAttribute('href');
                if (href === '#') return;
                
                e.preventDefault();
                navigationManager.scrollToSection(href);
            });
        });
    },
    
    scrollToSection: (selector) => {
        const target = document.querySelector(selector);
        if (!target) return;
        
        // Pour la section cours
        if (selector === '#courses') {
            setTimeout(() => {
                const coursesContainer = document.querySelector('.courses-container');
                if (coursesContainer) {
                    const containerRect = coursesContainer.getBoundingClientRect();
                    const scrollPosition = window.pageYOffset + containerRect.top - 120;
                    
                    window.scrollTo({
                        top: scrollPosition,
                        behavior: 'smooth'
                    });
                } else {
                    window.scrollTo({
                        top: target.offsetTop - 150,
                        behavior: 'smooth'
                    });
                }
            }, 50);
            return;
        }
        
        // Pour les autres sections
        const headerHeight = 100;
        window.scrollTo({
            top: target.offsetTop - headerHeight,
            behavior: 'smooth'
        });
    }
};

// ===== INTERACTIONS UTILISATEUR =====
const uiManager = {
    init: () => {
        // Bouton connexion desktop
        const loginBtn = document.querySelector('.login-btn');
        if (loginBtn) {
            loginBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const currentLang = languageManager.getCurrentLanguage();
                utils.showNotification(
                    currentLang === 'fr' 
                        ? 'Page de connexion en d√©veloppement' 
                        : 'Login page under development',
                    'info'
                );
            });
        }
        
        // Bouton connexion MOBILE
        const mobileLoginBtn = document.querySelector('.mobile-login-btn-header');
        if (mobileLoginBtn) {
            mobileLoginBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const currentLang = languageManager.getCurrentLanguage();
                utils.showNotification(
                    currentLang === 'fr' 
                        ? 'Page de connexion en d√©veloppement' 
                        : 'Login page under development',
                    'info'
                );
                mobileMenuManager.closeMobileMenu();
            });
        }
        
        // Gestion du scroll pour le header
        window.addEventListener('scroll', uiManager.handleScroll);
        uiManager.handleScroll();
    },
    
    handleScroll: utils.debounce(() => {
        const header = document.querySelector('.main-header');
        const aboutSection = document.querySelector('#about');
        
        if (!header) return;
        
        const aboutOffset = aboutSection ? aboutSection.offsetTop : 0;
        const scrollPosition = window.scrollY;
        
        if (scrollPosition > 100 || 
            (scrollPosition >= aboutOffset - 100 && scrollPosition <= aboutOffset + aboutSection.offsetHeight)) {
            header.classList.add('scrolled');
        } else {
            header.classList.remove('scrolled');
        }
    }, 10)
};

// ===== GESTION DE L'IMAGE =====
const imageManager = {
    init: () => {
        const yoannImage = document.getElementById('yoannImage');
        
        if (yoannImage) {
            yoannImage.addEventListener('error', () => {
                yoannImage.src = 'https://images.unsplash.com/photo-1568602471122-7832951cc4c5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80';
                yoannImage.alt = 'Professeur de fran√ßais';
            });
            
            yoannImage.addEventListener('load', () => {
                yoannImage.style.opacity = '1';
                yoannImage.style.transform = 'scale(1)';
            });
        }
    }
};

// ===== GESTION DU MENU MOBILE =====
const mobileMenuManager = {
    init: () => {
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const closeBtn = document.getElementById('closeMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileLinks = document.querySelectorAll('.mobile-nav-link');
        
        if (hamburgerBtn) {
            hamburgerBtn.addEventListener('click', () => {
                mobileMenuManager.toggleMobileMenu();
            });
        }
        
        if (closeBtn) {
            closeBtn.addEventListener('click', () => {
                mobileMenuManager.closeMobileMenu();
            });
        }
        
        // Fermer le menu en cliquant sur les liens
        mobileLinks.forEach(link => {
            link.addEventListener('click', () => {
                mobileMenuManager.closeMobileMenu();
                // Scroller vers la section
                const href = link.getAttribute('href');
                if (href && href !== '#') {
                    setTimeout(() => {
                        const target = document.querySelector(href);
                        if (target) {
                            window.scrollTo({
                                top: target.offsetTop - 100,
                                behavior: 'smooth'
                            });
                        }
                    }, 300);
                }
            });
        });
        
        // Fermer le menu en cliquant en dehors
        if (mobileMenu) {
            mobileMenu.addEventListener('click', (e) => {
                if (e.target === mobileMenu) {
                    mobileMenuManager.closeMobileMenu();
                }
            });
        }
        
        // Fermer le menu avec la touche √âchap
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                mobileMenuManager.closeMobileMenu();
            }
        });
    },
    
    toggleMobileMenu: () => {
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        
        if (mobileMenu.classList.contains('active')) {
            mobileMenu.classList.remove('active');
            hamburgerBtn.classList.remove('active');
            document.body.style.overflow = 'auto';
        } else {
            mobileMenu.classList.add('active');
            hamburgerBtn.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
    },
    
    closeMobileMenu: () => {
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        
        mobileMenu.classList.remove('active');
        hamburgerBtn.classList.remove('active');
        document.body.style.overflow = 'auto';
    }
};

// ===== INITIALISATION =====
const app = {
    init: () => {
        console.log('Initialisation de l\'application...');
        
        // Emp√™cher le retour en haut au rafra√Æchissement
        window.addEventListener('beforeunload', () => {
            sessionStorage.setItem('scrollPosition', window.scrollY);
        });
        
        if (sessionStorage.getItem('scrollPosition')) {
            window.addEventListener('load', () => {
                const savedPosition = parseInt(sessionStorage.getItem('scrollPosition'));
                setTimeout(() => {
                    window.scrollTo(0, savedPosition);
                    sessionStorage.removeItem('scrollPosition');
                }, 100);
            });
        }
        
        // V√©rifier que le DOM est charg√©
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', app.setup);
        } else {
            app.setup();
        }
    },
    
    setup: () => {
        console.log('Configuration des modules...');
        
        // Ajuster le padding pour le header fixe
        document.body.style.paddingTop = '80px';
        
        // Initialiser les managers - D'ABORD le gestionnaire de langue
        languageManager.init();
        mobileMenuManager.init();
        coursesManager.init();
        testimonialsManager.init();
        navigationManager.init();
        uiManager.init();
        imageManager.init();
        
        // Gestion du redimensionnement
        window.addEventListener('resize', utils.debounce(() => {
            testimonialsManager.calculateSlidesPerView();
            testimonialsManager.updateSlider();
        }, 250));
        
        console.log('Application pr√™te ! Langue:', languageManager.getCurrentLanguage());
    }
};

// ===== D√âMARRAGE DE L'APPLICATION =====
app.init();

// Exposer certaines fonctions globalement pour le d√©bogage
window.appDebug = {
    reloadTestimonials: () => {
        testimonialsManager.init();
        utils.showNotification('T√©moignages recharg√©s', 'success');
    },
    
    nextSlide: () => testimonialsManager.nextSlide(),
    prevSlide: () => testimonialsManager.prevSlide(),
    
    showTestNotification: () => {
        utils.showNotification('Notification de test', 'success');
    },
    
    testScrollToCourses: () => {
        navigationManager.scrollToSection('#courses');
    },
    
    testMenu: () => {
        mobileMenuManager.toggleMobileMenu();
    },
    
    switchLanguage: () => {
        languageManager.toggleLanguage();
    },
    
    getCurrentLanguage: () => {
        return languageManager.getCurrentLanguage();
    }
};